<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Absensi & Nilai SMP Negeri 05 Namrole</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f0f4f8;
        }
        .logo {
            width: 60px;
            height: 60px;
            background-color: #e53e3e;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 24px;
        }
        .nav-item {
            transition: all 0.3s;
            cursor: pointer;
        }
        .nav-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }
        .nav-item.active {
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 8px;
        }
        .card {
            transition: all 0.3s;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .modal {
            transition: opacity 0.3s ease;
        }
        .modal-content {
            transition: transform 0.3s ease;
        }
        .show {
            opacity: 1;
            pointer-events: auto;
        }
        .show .modal-content {
            transform: translateY(0);
        }
        .hide {
            opacity: 0;
            pointer-events: none;
        }
        .hide .modal-content {
            transform: translateY(-50px);
        }
        .teacher-badge {
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 4px 12px;
            font-size: 12px;
            display: inline-flex;
            align-items: center;
            margin-top: 4px;
        }
        .teacher-badge svg {
            margin-right: 4px;
        }
        .tab-button {
            transition: all 0.3s;
        }
        .tab-button.active {
            background-color: #e53e3e;
            color: white;
        }
        .status-btn {
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        .status-btn:hover {
            transform: translateY(-2px);
        }
        .status-btn.active {
            border: 2px solid #4a5568;
            transform: translateY(-2px);
        }
        .status-hadir {
            background-color: #c6f6d5;
            color: #22543d;
        }
        .status-sakit {
            background-color: #feebc8;
            color: #744210;
        }
        .status-izin {
            background-color: #e9d8fd;
            color: #44337a;
        }
        .status-alpha {
            background-color: #fed7d7;
            color: #742a2a;
        }
    </style>
</head>
<body>
    <div class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-red-600 text-white shadow-lg">
            <div class="container mx-auto px-4 py-3 flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <div class="logo">P</div>
                    <div>
                        <h1 class="text-xl font-bold">SIAP Pancasila</h1>
                        <p class="text-xs">SMP Negeri 05 Namrole</p>
                        <div class="teacher-badge">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                            <span>Riska Maria Souhoka, S.Pd.,Gr</span>
                        </div>
                    </div>
                </div>
                <nav class="hidden md:flex space-x-1">
                    <a href="#dashboard" class="nav-item px-4 py-2 text-white font-medium active" onclick="switchTab('dashboard')">Dashboard</a>
                    <a href="#students" class="nav-item px-4 py-2 text-white font-medium" onclick="switchTab('students')">Data Siswa</a>
                    <a href="#attendance" class="nav-item px-4 py-2 text-white font-medium" onclick="switchTab('attendance')">Absensi</a>
                    <a href="#grades" class="nav-item px-4 py-2 text-white font-medium" onclick="switchTab('grades')">Nilai</a>
                    <a href="#reports" class="nav-item px-4 py-2 text-white font-medium" onclick="switchTab('reports')">Laporan</a>
                </nav>
                <button id="mobile-menu-button" class="md:hidden text-white">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
            </div>
            <!-- Mobile Menu -->
            <div id="mobile-menu" class="hidden md:hidden bg-red-700 px-4 py-2">
                <a href="#dashboard" class="nav-item block w-full text-left px-4 py-2 text-white font-medium" onclick="switchTab('dashboard'); toggleMobileMenu();">Dashboard</a>
                <a href="#students" class="nav-item block w-full text-left px-4 py-2 text-white font-medium" onclick="switchTab('students'); toggleMobileMenu();">Data Siswa</a>
                <a href="#attendance" class="nav-item block w-full text-left px-4 py-2 text-white font-medium" onclick="switchTab('attendance'); toggleMobileMenu();">Absensi</a>
                <a href="#grades" class="nav-item block w-full text-left px-4 py-2 text-white font-medium" onclick="switchTab('grades'); toggleMobileMenu();">Nilai</a>
                <a href="#reports" class="nav-item block w-full text-left px-4 py-2 text-white font-medium" onclick="switchTab('reports'); toggleMobileMenu();">Laporan</a>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-grow container mx-auto px-4 py-8">
            <!-- Dashboard Section -->
            <section id="dashboard-section" class="space-y-6">
                <div class="flex justify-between items-center">
                    <h2 class="text-2xl font-bold text-gray-800">Dashboard</h2>
                    <div class="text-sm text-gray-600" id="current-date"></div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                    <div class="flex flex-col md:flex-row items-center md:space-x-4">
                        <div class="w-24 h-24 bg-red-100 rounded-full flex items-center justify-center mb-4 md:mb-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                        </div>
                        <div class="text-center md:text-left">
                            <h3 class="text-xl font-semibold text-gray-800">Riska Maria Souhoka, S.Pd.,Gr</h3>
                            <p class="text-gray-600">Guru Mata Pelajaran Pendidikan Pancasila</p>
                            <p class="text-gray-600">SMP Negeri 05 Namrole</p>
                            <div class="mt-2 flex flex-wrap justify-center md:justify-start gap-2">
                                <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full">SMP</span>
                                <span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Guru Profesional</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="card bg-white rounded-lg shadow-md p-6 border-l-4 border-blue-500">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-sm text-gray-600">Total Siswa</p>
                                <h3 class="text-2xl font-bold text-gray-800" id="total-students">0</h3>
                            </div>
                            <div class="bg-blue-100 p-3 rounded-full">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="card bg-white rounded-lg shadow-md p-6 border-l-4 border-green-500">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-sm text-gray-600">Hadir Hari Ini</p>
                                <h3 class="text-2xl font-bold text-gray-800" id="present-today">0</h3>
                            </div>
                            <div class="bg-green-100 p-3 rounded-full">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="card bg-white rounded-lg shadow-md p-6 border-l-4 border-red-500">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-sm text-gray-600">Tidak Hadir Hari Ini</p>
                                <h3 class="text-2xl font-bold text-gray-800" id="absent-today">0</h3>
                            </div>
                            <div class="bg-red-100 p-3 rounded-full">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Ringkasan Kelas</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white">
                            <thead>
                                <tr class="bg-gray-100 text-gray-600 uppercase text-sm leading-normal">
                                    <th class="py-3 px-6 text-left">Kelas</th>
                                    <th class="py-3 px-6 text-center">Jumlah Siswa</th>
                                    <th class="py-3 px-6 text-center">Hadir Hari Ini</th>
                                    <th class="py-3 px-6 text-center">Persentase Kehadiran</th>
                                </tr>
                            </thead>
                            <tbody class="text-gray-600 text-sm" id="class-summary">
                                <tr class="border-b border-gray-200 hover:bg-gray-50">
                                    <td class="py-3 px-6 text-left">Kelas 7</td>
                                    <td class="py-3 px-6 text-center">0</td>
                                    <td class="py-3 px-6 text-center">0</td>
                                    <td class="py-3 px-6 text-center">0%</td>
                                </tr>
                                <tr class="border-b border-gray-200 hover:bg-gray-50">
                                    <td class="py-3 px-6 text-left">Kelas 8</td>
                                    <td class="py-3 px-6 text-center">0</td>
                                    <td class="py-3 px-6 text-center">0</td>
                                    <td class="py-3 px-6 text-center">0%</td>
                                </tr>
                                <tr class="border-b border-gray-200 hover:bg-gray-50">
                                    <td class="py-3 px-6 text-left">Kelas 9</td>
                                    <td class="py-3 px-6 text-center">0</td>
                                    <td class="py-3 px-6 text-center">0</td>
                                    <td class="py-3 px-6 text-center">0%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Students Section -->
            <section id="students-section" class="space-y-6 hidden">
                <div class="flex justify-between items-center">
                    <h2 class="text-2xl font-bold text-gray-800">Data Siswa</h2>
                    <button id="add-student-btn" class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                        </svg>
                        Tambah Siswa
                    </button>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6">
                    <div class="flex flex-col md:flex-row justify-between mb-4 space-y-3 md:space-y-0">
                        <div class="flex items-center space-x-2">
                            <label for="filter-class" class="text-gray-600">Kelas:</label>
                            <select id="filter-class" class="border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                                <option value="all">Semua</option>
                                <option value="7">Kelas 7</option>
                                <option value="8">Kelas 8</option>
                                <option value="9">Kelas 9</option>
                            </select>
                        </div>
                        <div class="relative">
                            <input type="text" id="search-student" placeholder="Cari siswa..." class="border rounded-lg pl-10 pr-4 py-2 w-full md:w-64 focus:outline-none focus:ring-2 focus:ring-red-500">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400 absolute left-3 top-2.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                            </svg>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white">
                            <thead>
                                <tr class="bg-gray-100 text-gray-600 uppercase text-sm leading-normal">
                                    <th class="py-3 px-6 text-left">NIS</th>
                                    <th class="py-3 px-6 text-left">Nama</th>
                                    <th class="py-3 px-6 text-center">Kelas</th>
                                    <th class="py-3 px-6 text-center">Jenis Kelamin</th>
                                    <th class="py-3 px-6 text-center">Aksi</th>
                                </tr>
                            </thead>
                            <tbody class="text-gray-600 text-sm" id="students-table">
                                <!-- Student data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                    <div id="no-students" class="text-center py-4 text-gray-500">Belum ada data siswa</div>
                </div>
            </section>

            <!-- Attendance Section -->
            <section id="attendance-section" class="space-y-6 hidden">
                <div class="flex justify-between items-center">
                    <h2 class="text-2xl font-bold text-gray-800">Absensi</h2>
                    <div class="text-sm text-gray-600" id="attendance-date"></div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6">
                    <div class="flex flex-col md:flex-row justify-between mb-6 space-y-3 md:space-y-0">
                        <div class="flex items-center space-x-2">
                            <label for="attendance-class" class="text-gray-600">Kelas:</label>
                            <select id="attendance-class" class="border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                                <option value="7">Kelas 7</option>
                                <option value="8">Kelas 8</option>
                                <option value="9">Kelas 9</option>
                            </select>
                        </div>
                        <div class="flex items-center space-x-2">
                            <label for="attendance-date-input" class="text-gray-600">Tanggal:</label>
                            <input type="date" id="attendance-date-input" class="border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                        </div>
                    </div>
                    
                    <div class="mb-4 p-3 bg-blue-50 rounded-lg border border-blue-200">
                        <div class="flex items-center text-blue-800">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <span>Klik tombol status untuk mengisi absensi. Waktu akan otomatis terisi.</span>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white">
                            <thead>
                                <tr class="bg-gray-100 text-gray-600 uppercase text-sm leading-normal">
                                    <th class="py-3 px-6 text-left">NIS</th>
                                    <th class="py-3 px-6 text-left">Nama</th>
                                    <th class="py-3 px-6 text-center">Status</th>
                                    <th class="py-3 px-6 text-center">Waktu</th>
                                    <th class="py-3 px-6 text-center">Keterangan</th>
                                </tr>
                            </thead>
                            <tbody class="text-gray-600 text-sm" id="attendance-table">
                                <!-- Attendance data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                    <div id="no-attendance-data" class="text-center py-4 text-gray-500">Pilih kelas untuk melihat data absensi</div>
                    <div class="mt-6 flex justify-end">
                        <button id="save-attendance" class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4" />
                            </svg>
                            Simpan Absensi
                        </button>
                    </div>
                </div>
            </section>

            <!-- Grades Section -->
            <section id="grades-section" class="space-y-6 hidden">
                <div class="flex justify-between items-center">
                    <h2 class="text-2xl font-bold text-gray-800">Nilai</h2>
                    <div class="text-sm text-gray-600" id="grades-semester"></div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6">
                    <div class="flex flex-col md:flex-row justify-between mb-6 space-y-3 md:space-y-0">
                        <div class="flex items-center space-x-2">
                            <label for="grades-class" class="text-gray-600">Kelas:</label>
                            <select id="grades-class" class="border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                                <option value="7">Kelas 7</option>
                                <option value="8">Kelas 8</option>
                                <option value="9">Kelas 9</option>
                            </select>
                        </div>
                        <div class="flex items-center space-x-2">
                            <label for="grades-type" class="text-gray-600">Jenis Nilai:</label>
                            <select id="grades-type" class="border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                                <option value="tugas">Nilai Tugas</option>
                                <option value="uts">Sumatif Tengah Semester</option>
                                <option value="uas">Sumatif Akhir Semester</option>
                            </select>
                        </div>
                    </div>

                    <!-- Tugas Tab Content -->
                    <div id="tugas-tab" class="grades-tab">
                        <div class="overflow-x-auto">
                            <table class="min-w-full bg-white">
                                <thead>
                                    <tr class="bg-gray-100 text-gray-600 uppercase text-sm leading-normal">
                                        <th class="py-3 px-6 text-left">NIS</th>
                                        <th class="py-3 px-6 text-left">Nama</th>
                                        <th class="py-3 px-6 text-center">Tugas 1</th>
                                        <th class="py-3 px-6 text-center">Tugas 2</th>
                                        <th class="py-3 px-6 text-center">Tugas 3</th>
                                        <th class="py-3 px-6 text-center">Rata-rata</th>
                                    </tr>
                                </thead>
                                <tbody class="text-gray-600 text-sm" id="tugas-table">
                                    <!-- Tugas data will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- UTS Tab Content -->
                    <div id="uts-tab" class="grades-tab hidden">
                        <div class="overflow-x-auto">
                            <table class="min-w-full bg-white">
                                <thead>
                                    <tr class="bg-gray-100 text-gray-600 uppercase text-sm leading-normal">
                                        <th class="py-3 px-6 text-left">NIS</th>
                                        <th class="py-3 px-6 text-left">Nama</th>
                                        <th class="py-3 px-6 text-center">Nilai Sumatif Tengah Semester</th>
                                    </tr>
                                </thead>
                                <tbody class="text-gray-600 text-sm" id="uts-table">
                                    <!-- UTS data will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- UAS Tab Content -->
                    <div id="uas-tab" class="grades-tab hidden">
                        <div class="overflow-x-auto">
                            <table class="min-w-full bg-white">
                                <thead>
                                    <tr class="bg-gray-100 text-gray-600 uppercase text-sm leading-normal">
                                        <th class="py-3 px-6 text-left">NIS</th>
                                        <th class="py-3 px-6 text-left">Nama</th>
                                        <th class="py-3 px-6 text-center">Nilai Sumatif Akhir Semester</th>
                                    </tr>
                                </thead>
                                <tbody class="text-gray-600 text-sm" id="uas-table">
                                    <!-- UAS data will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div id="no-grades-data" class="text-center py-4 text-gray-500">Pilih kelas untuk melihat data nilai</div>
                    <div class="mt-6 flex justify-end">
                        <button id="save-grades" class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4" />
                            </svg>
                            Simpan Nilai
                        </button>
                        <button id="export-grades" class="ml-2 bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                            </svg>
                            Ekspor Nilai
                        </button>
                    </div>
                </div>
            </section>

            <!-- Reports Section -->
            <section id="reports-section" class="space-y-6 hidden">
                <div class="flex justify-between items-center">
                    <h2 class="text-2xl font-bold text-gray-800">Laporan</h2>
                    <div class="flex space-x-2">
                        <select id="report-type" class="border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                            <option value="attendance">Laporan Absensi</option>
                            <option value="grades">Laporan Nilai</option>
                        </select>
                        <button id="export-report" class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                            </svg>
                            Ekspor Laporan
                        </button>
                    </div>
                </div>

                <!-- Attendance Report -->
                <div id="attendance-report" class="bg-white rounded-lg shadow-md p-6">
                    <div class="flex flex-col md:flex-row justify-between mb-6 space-y-3 md:space-y-0">
                        <div class="flex items-center space-x-2">
                            <label for="report-class" class="text-gray-600">Kelas:</label>
                            <select id="report-class" class="border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                                <option value="all">Semua</option>
                                <option value="7">Kelas 7</option>
                                <option value="8">Kelas 8</option>
                                <option value="9">Kelas 9</option>
                            </select>
                        </div>
                        <div class="flex items-center space-x-2">
                            <label for="report-month" class="text-gray-600">Bulan:</label>
                            <select id="report-month" class="border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                                <option value="1">Januari</option>
                                <option value="2">Februari</option>
                                <option value="3">Maret</option>
                                <option value="4">April</option>
                                <option value="5">Mei</option>
                                <option value="6">Juni</option>
                                <option value="7">Juli</option>
                                <option value="8">Agustus</option>
                                <option value="9">September</option>
                                <option value="10">Oktober</option>
                                <option value="11">November</option>
                                <option value="12">Desember</option>
                            </select>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white">
                            <thead>
                                <tr class="bg-gray-100 text-gray-600 uppercase text-sm leading-normal">
                                    <th class="py-3 px-6 text-left">NIS</th>
                                    <th class="py-3 px-6 text-left">Nama</th>
                                    <th class="py-3 px-6 text-center">Kelas</th>
                                    <th class="py-3 px-6 text-center">Hadir</th>
                                    <th class="py-3 px-6 text-center">Sakit</th>
                                    <th class="py-3 px-6 text-center">Izin</th>
                                    <th class="py-3 px-6 text-center">Alpha</th>
                                    <th class="py-3 px-6 text-center">Persentase</th>
                                </tr>
                            </thead>
                            <tbody class="text-gray-600 text-sm" id="report-table">
                                <!-- Report data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                    <div id="no-report-data" class="text-center py-4 text-gray-500">Belum ada data laporan</div>
                </div>

                <!-- Grades Report -->
                <div id="grades-report" class="bg-white rounded-lg shadow-md p-6 hidden">
                    <div class="flex flex-col md:flex-row justify-between mb-6 space-y-3 md:space-y-0">
                        <div class="flex items-center space-x-2">
                            <label for="grades-report-class" class="text-gray-600">Kelas:</label>
                            <select id="grades-report-class" class="border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                                <option value="all">Semua</option>
                                <option value="7">Kelas 7</option>
                                <option value="8">Kelas 8</option>
                                <option value="9">Kelas 9</option>
                            </select>
                        </div>
                        <div class="flex items-center space-x-2">
                            <label for="grades-report-type" class="text-gray-600">Jenis Nilai:</label>
                            <select id="grades-report-type" class="border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                                <option value="all">Semua</option>
                                <option value="tugas">Nilai Tugas</option>
                                <option value="uts">Sumatif Tengah Semester</option>
                                <option value="uas">Sumatif Akhir Semester</option>
                            </select>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white">
                            <thead>
                                <tr class="bg-gray-100 text-gray-600 uppercase text-sm leading-normal">
                                    <th class="py-3 px-6 text-left">NIS</th>
                                    <th class="py-3 px-6 text-left">Nama</th>
                                    <th class="py-3 px-6 text-center">Kelas</th>
                                    <th class="py-3 px-6 text-center">Tugas 1</th>
                                    <th class="py-3 px-6 text-center">Tugas 2</th>
                                    <th class="py-3 px-6 text-center">Tugas 3</th>
                                    <th class="py-3 px-6 text-center">Rata-rata Tugas</th>
                                    <th class="py-3 px-6 text-center">UTS</th>
                                    <th class="py-3 px-6 text-center">UAS</th>
                                    <th class="py-3 px-6 text-center">Nilai Akhir</th>
                                </tr>
                            </thead>
                            <tbody class="text-gray-600 text-sm" id="grades-report-table">
                                <!-- Grades report data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                    <div id="no-grades-report-data" class="text-center py-4 text-gray-500">Belum ada data laporan nilai</div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="bg-gray-800 text-white py-4">
            <div class="container mx-auto px-4 text-center">
                <p>&copy; 2023 SMP Negeri 05 Namrole</p>
                <p class="text-sm text-gray-400 mt-1">Sistem Absensi & Nilai Pendidikan Pancasila</p>
                <p class="text-sm text-gray-400">Dikelola oleh: Riska Maria Souhoka, S.Pd.,Gr</p>
            </div>
        </footer>
    </div>

    <!-- Add Student Modal -->
    <div id="add-student-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hide">
        <div class="modal-content bg-white rounded-lg shadow-xl w-full max-w-md mx-4 transform -translate-y-10">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-gray-800">Tambah Siswa Baru</h3>
                    <button class="close-modal text-gray-400 hover:text-gray-600">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                <form id="add-student-form" class="space-y-4">
                    <div>
                        <label for="student-nis" class="block text-sm font-medium text-gray-700 mb-1">NIS</label>
                        <input type="text" id="student-nis" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" required>
                    </div>
                    <div>
                        <label for="student-name" class="block text-sm font-medium text-gray-700 mb-1">Nama Lengkap</label>
                        <input type="text" id="student-name" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" required>
                    </div>
                    <div>
                        <label for="student-class" class="block text-sm font-medium text-gray-700 mb-1">Kelas</label>
                        <select id="student-class" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" required>
                            <option value="7">Kelas 7</option>
                            <option value="8">Kelas 8</option>
                            <option value="9">Kelas 9</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Jenis Kelamin</label>
                        <div class="flex space-x-4">
                            <label class="inline-flex items-center">
                                <input type="radio" name="gender" value="L" class="form-radio text-red-600" checked>
                                <span class="ml-2">Laki-laki</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" name="gender" value="P" class="form-radio text-red-600">
                                <span class="ml-2">Perempuan</span>
                            </label>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 pt-4">
                        <button type="button" class="close-modal bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded-lg">Batal</button>
                        <button type="submit" class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg">Simpan</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Edit Student Modal -->
    <div id="edit-student-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hide">
        <div class="modal-content bg-white rounded-lg shadow-xl w-full max-w-md mx-4 transform -translate-y-10">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-gray-800">Edit Data Siswa</h3>
                    <button class="close-modal text-gray-400 hover:text-gray-600">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                <form id="edit-student-form" class="space-y-4">
                    <input type="hidden" id="edit-student-id">
                    <div>
                        <label for="edit-student-nis" class="block text-sm font-medium text-gray-700 mb-1">NIS</label>
                        <input type="text" id="edit-student-nis" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" required>
                    </div>
                    <div>
                        <label for="edit-student-name" class="block text-sm font-medium text-gray-700 mb-1">Nama Lengkap</label>
                        <input type="text" id="edit-student-name" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" required>
                    </div>
                    <div>
                        <label for="edit-student-class" class="block text-sm font-medium text-gray-700 mb-1">Kelas</label>
                        <select id="edit-student-class" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" required>
                            <option value="7">Kelas 7</option>
                            <option value="8">Kelas 8</option>
                            <option value="9">Kelas 9</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Jenis Kelamin</label>
                        <div class="flex space-x-4">
                            <label class="inline-flex items-center">
                                <input type="radio" name="edit-gender" value="L" class="form-radio text-red-600">
                                <span class="ml-2">Laki-laki</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" name="edit-gender" value="P" class="form-radio text-red-600">
                                <span class="ml-2">Perempuan</span>
                            </label>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 pt-4">
                        <button type="button" class="close-modal bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded-lg">Batal</button>
                        <button type="submit" class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg">Simpan</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="delete-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hide">
        <div class="modal-content bg-white rounded-lg shadow-xl w-full max-w-md mx-4 transform -translate-y-10">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-gray-800">Konfirmasi Hapus</h3>
                    <button class="close-modal text-gray-400 hover:text-gray-600">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                <p class="text-gray-600 mb-6">Apakah Anda yakin ingin menghapus data siswa ini? Tindakan ini tidak dapat dibatalkan.</p>
                <input type="hidden" id="delete-student-id">
                <div class="flex justify-end space-x-3">
                    <button class="close-modal bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded-lg">Batal</button>
                    <button id="confirm-delete" class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg">Hapus</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-4 right-4 bg-gray-800 text-white px-6 py-3 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-300 flex items-center z-50">
        <span id="toast-message">Pesan notifikasi</span>
    </div>

    <script>
        // Data Storage
        let students = JSON.parse(localStorage.getItem('students')) || [];
        let attendance = JSON.parse(localStorage.getItem('attendance')) || {};
        let grades = JSON.parse(localStorage.getItem('grades')) || {
            tugas: {},
            uts: {},
            uas: {}
        };

        // Initialize with sample data if empty
        if (students.length === 0) {
            const sampleNames = [
                "Adi Nugroho", "Budi Santoso", "Citra Dewi", "Dian Pratama", "Eko Widodo",
                "Fitri Handayani", "Galih Purnama", "Hana Wijaya", "Indra Kusuma", "Joko Susilo"
            ];
            
            let id = 1;
            for (let classNum = 7; classNum <= 9; classNum++) {
                for (let i = 0; i < 10; i++) {
                    const randomName = sampleNames[Math.floor(Math.random() * sampleNames.length)] + " " + String.fromCharCode(65 + i);
                    students.push({
                        id: id++,
                        nis: `${classNum}${String(i+1).padStart(3, '0')}`,
                        name: randomName,
                        class: classNum.toString(),
                        gender: Math.random() > 0.5 ? 'L' : 'P'
                    });
                }
            }
            localStorage.setItem('students', JSON.stringify(students));
        }

        // Initialize grades with sample data if empty
        if (!grades.tugas || Object.keys(grades.tugas).length === 0) {
            students.forEach(student => {
                // Initialize tugas
                if (!grades.tugas[student.id]) {
                    grades.tugas[student.id] = {
                        tugas1: Math.floor(Math.random() * 31) + 70, // 70-100
                        tugas2: Math.floor(Math.random() * 31) + 70,
                        tugas3: Math.floor(Math.random() * 31) + 70
                    };
                }
                
                // Initialize UTS
                if (!grades.uts[student.id]) {
                    grades.uts[student.id] = Math.floor(Math.random() * 31) + 70;
                }
                
                // Initialize UAS
                if (!grades.uas[student.id]) {
                    grades.uas[student.id] = Math.floor(Math.random() * 31) + 70;
                }
            });
            
            localStorage.setItem('grades', JSON.stringify(grades));
        }

        // Utility Functions
        function formatDate(date) {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            return date.toLocaleDateString('id-ID', options);
        }

        function formatTime(date) {
            return date.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toast-message');
            
            toastMessage.textContent = message;
            toast.classList.remove('translate-y-20', 'opacity-0');
            toast.classList.add('translate-y-0', 'opacity-100');
            
            setTimeout(() => {
                toast.classList.remove('translate-y-0', 'opacity-100');
                toast.classList.add('translate-y-20', 'opacity-0');
            }, 3000);
        }

        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('hide');
            modal.classList.add('show');
        }

        function hideModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('show');
            modal.classList.add('hide');
        }

        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('main > section').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show the selected section
            document.getElementById(sectionId).classList.remove('hidden');
        }

        // Navigation
        function switchTab(tab) {
            // Update active tab
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Find the clicked tab and add active class
            document.querySelectorAll(`.nav-item[href="#${tab}"]`).forEach(item => {
                item.classList.add('active');
            });
            
            // Show corresponding section
            switch(tab) {
                case 'dashboard':
                    showSection('dashboard-section');
                    updateDashboard();
                    break;
                case 'students':
                    showSection('students-section');
                    renderStudentsTable();
                    break;
                case 'attendance':
                    showSection('attendance-section');
                    const today = new Date();
                    document.getElementById('attendance-date-input').value = today.toISOString().split('T')[0];
                    document.getElementById('attendance-date').textContent = formatDate(today);
                    renderAttendanceTable();
                    break;
                case 'grades':
                    showSection('grades-section');
                    document.getElementById('grades-semester').textContent = 'Semester Ganjil ' + new Date().getFullYear();
                    renderGradesTable();
                    break;
                case 'reports':
                    showSection('reports-section');
                    const currentMonth = new Date().getMonth() + 1;
                    document.getElementById('report-month').value = currentMonth;
                    renderReportTable();
                    break;
            }
        }

        // Mobile Menu Toggle
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('hidden');
        }

        document.getElementById('mobile-menu-button').addEventListener('click', toggleMobileMenu);

        // Close Modals
        document.querySelectorAll('.close-modal').forEach(button => {
            button.addEventListener('click', () => {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.classList.remove('show');
                    modal.classList.add('hide');
                });
            });
        });

        // Add Student
        document.getElementById('add-student-btn').addEventListener('click', () => {
            showModal('add-student-modal');
        });

        document.getElementById('add-student-form').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const nis = document.getElementById('student-nis').value;
            const name = document.getElementById('student-name').value;
            const classValue = document.getElementById('student-class').value;
            const gender = document.querySelector('input[name="gender"]:checked').value;
            
            // Check if NIS already exists
            if (students.some(student => student.nis === nis)) {
                showToast('NIS sudah terdaftar!');
                return;
            }
            
            // Add new student
            const newStudent = {
                id: students.length > 0 ? Math.max(...students.map(s => s.id)) + 1 : 1,
                nis,
                name,
                class: classValue,
                gender
            };
            
            students.push(newStudent);
            localStorage.setItem('students', JSON.stringify(students));
            
            // Initialize grades for new student
            grades.tugas[newStudent.id] = {
                tugas1: 0,
                tugas2: 0,
                tugas3: 0
            };
            grades.uts[newStudent.id] = 0;
            grades.uas[newStudent.id] = 0;
            localStorage.setItem('grades', JSON.stringify(grades));
            
            // Reset form and close modal
            document.getElementById('add-student-form').reset();
            hideModal('add-student-modal');
            
            // Update UI
            renderStudentsTable();
            updateDashboard();
            showToast('Siswa berhasil ditambahkan!');
        });

        // Edit Student
        function openEditModal(studentId) {
            const student = students.find(s => s.id === studentId);
            if (!student) return;
            
            document.getElementById('edit-student-id').value = student.id;
            document.getElementById('edit-student-nis').value = student.nis;
            document.getElementById('edit-student-name').value = student.name;
            document.getElementById('edit-student-class').value = student.class;
            
            const genderRadios = document.getElementsByName('edit-gender');
            for (let radio of genderRadios) {
                if (radio.value === student.gender) {
                    radio.checked = true;
                }
            }
            
            showModal('edit-student-modal');
        }

        document.getElementById('edit-student-form').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const id = parseInt(document.getElementById('edit-student-id').value);
            const nis = document.getElementById('edit-student-nis').value;
            const name = document.getElementById('edit-student-name').value;
            const classValue = document.getElementById('edit-student-class').value;
            const gender = document.querySelector('input[name="edit-gender"]:checked').value;
            
            // Check if NIS already exists (excluding current student)
            if (students.some(student => student.nis === nis && student.id !== id)) {
                showToast('NIS sudah terdaftar!');
                return;
            }
            
            // Update student
            const index = students.findIndex(s => s.id === id);
            if (index !== -1) {
                students[index] = {
                    id,
                    nis,
                    name,
                    class: classValue,
                    gender
                };
                
                localStorage.setItem('students', JSON.stringify(students));
                
                // Reset form and close modal
                document.getElementById('edit-student-form').reset();
                hideModal('edit-student-modal');
                
                // Update UI
                renderStudentsTable();
                updateDashboard();
                showToast('Data siswa berhasil diperbarui!');
            }
        });

        // Delete Student
        function openDeleteModal(studentId) {
            document.getElementById('delete-student-id').value = studentId;
            showModal('delete-modal');
        }

        document.getElementById('confirm-delete').addEventListener('click', () => {
            const id = parseInt(document.getElementById('delete-student-id').value);
            
            // Delete student
            students = students.filter(student => student.id !== id);
            localStorage.setItem('students', JSON.stringify(students));
            
            // Delete student grades
            delete grades.tugas[id];
            delete grades.uts[id];
            delete grades.uas[id];
            localStorage.setItem('grades', JSON.stringify(grades));
            
            // Close modal
            hideModal('delete-modal');
            
            // Update UI
            renderStudentsTable();
            updateDashboard();
            showToast('Siswa berhasil dihapus!');
        });

        // Render Students Table
        function renderStudentsTable() {
            const tableBody = document.getElementById('students-table');
            const noStudentsMsg = document.getElementById('no-students');
            const filterClass = document.getElementById('filter-class').value;
            const searchQuery = document.getElementById('search-student').value.toLowerCase();
            
            // Filter students
            let filteredStudents = students;
            
            if (filterClass !== 'all') {
                filteredStudents = filteredStudents.filter(student => student.class === filterClass);
            }
            
            if (searchQuery) {
                filteredStudents = filteredStudents.filter(student => 
                    student.name.toLowerCase().includes(searchQuery) || 
                    student.nis.toLowerCase().includes(searchQuery)
                );
            }
            
            // Clear table
            tableBody.innerHTML = '';
            
            // Show/hide no students message
            if (filteredStudents.length === 0) {
                noStudentsMsg.classList.remove('hidden');
                return;
            } else {
                noStudentsMsg.classList.add('hidden');
            }
            
            // Populate table
            filteredStudents.forEach(student => {
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-200 hover:bg-gray-50';
                
                row.innerHTML = `
                    <td class="py-3 px-6 text-left">${student.nis}</td>
                    <td class="py-3 px-6 text-left">${student.name}</td>
                    <td class="py-3 px-6 text-center">Kelas ${student.class}</td>
                    <td class="py-3 px-6 text-center">${student.gender === 'L' ? 'Laki-laki' : 'Perempuan'}</td>
                    <td class="py-3 px-6 text-center">
                        <div class="flex justify-center items-center space-x-2">
                            <button class="edit-btn text-blue-600 hover:text-blue-800" data-id="${student.id}">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                                </svg>
                            </button>
                            <button class="delete-btn text-red-600 hover:text-red-800" data-id="${student.id}">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                </svg>
                            </button>
                        </div>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Add event listeners to edit and delete buttons
            document.querySelectorAll('.edit-btn').forEach(button => {
                button.addEventListener('click', () => {
                    openEditModal(parseInt(button.dataset.id));
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(button => {
                button.addEventListener('click', () => {
                    openDeleteModal(parseInt(button.dataset.id));
                });
            });
        }

        // Filter and Search Students
        document.getElementById('filter-class').addEventListener('change', renderStudentsTable);
        document.getElementById('search-student').addEventListener('input', renderStudentsTable);

        // Attendance Management
        function renderAttendanceTable() {
            const tableBody = document.getElementById('attendance-table');
            const noDataMsg = document.getElementById('no-attendance-data');
            const selectedClass = document.getElementById('attendance-class').value;
            const selectedDate = document.getElementById('attendance-date-input').value;
            
            // Clear table
            tableBody.innerHTML = '';
            
            // Get students for the selected class
            const classStudents = students.filter(student => student.class === selectedClass);
            
            // Show/hide no data message
            if (classStudents.length === 0) {
                noDataMsg.textContent = 'Tidak ada siswa di kelas ini';
                noDataMsg.classList.remove('hidden');
                return;
            } else {
                noDataMsg.classList.add('hidden');
            }
            
            // Get attendance data for the selected date and class
            const dateKey = selectedDate;
            const attendanceData = attendance[dateKey] || {};
            
            // Populate table
            classStudents.forEach(student => {
                const studentAttendance = attendanceData[student.id] || { status: '', time: '', note: '' };
                
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-200 hover:bg-gray-50';
                
                // Create status buttons with appropriate classes
                const statusButtons = `
                    <div class="flex space-x-1 justify-center">
                        <button type="button" class="status-btn status-hadir rounded-md px-3 py-1 text-sm font-medium ${studentAttendance.status === 'H' ? 'active' : ''}" 
                            data-id="${student.id}" data-status="H">Hadir</button>
                        <button type="button" class="status-btn status-sakit rounded-md px-3 py-1 text-sm font-medium ${studentAttendance.status === 'S' ? 'active' : ''}" 
                            data-id="${student.id}" data-status="S">Sakit</button>
                        <button type="button" class="status-btn status-izin rounded-md px-3 py-1 text-sm font-medium ${studentAttendance.status === 'I' ? 'active' : ''}" 
                            data-id="${student.id}" data-status="I">Izin</button>
                        <button type="button" class="status-btn status-alpha rounded-md px-3 py-1 text-sm font-medium ${studentAttendance.status === 'A' ? 'active' : ''}" 
                            data-id="${student.id}" data-status="A">Alpha</button>
                    </div>
                `;
                
                row.innerHTML = `
                    <td class="py-3 px-6 text-left">${student.nis}</td>
                    <td class="py-3 px-6 text-left">${student.name}</td>
                    <td class="py-3 px-6 text-center">${statusButtons}</td>
                    <td class="py-3 px-6 text-center">
                        <span class="attendance-time" data-id="${student.id}">${studentAttendance.time || '-'}</span>
                    </td>
                    <td class="py-3 px-6 text-center">
                        <input type="text" class="attendance-note border rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-red-500" data-id="${student.id}" value="${studentAttendance.note || ''}" placeholder="Keterangan">
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Add event listeners to status buttons
            document.querySelectorAll('.status-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const studentId = parseInt(e.target.dataset.id);
                    const status = e.target.dataset.status;
                    const currentTime = formatTime(new Date());
                    
                    // Remove active class from all buttons in the same row
                    const row = e.target.closest('tr');
                    row.querySelectorAll('.status-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    // Add active class to clicked button
                    e.target.classList.add('active');
                    
                    // Update time display
                    row.querySelector('.attendance-time').textContent = currentTime;
                    
                    // Save attendance data
                    const dateKey = document.getElementById('attendance-date-input').value;
                    if (!attendance[dateKey]) {
                        attendance[dateKey] = {};
                    }
                    
                    // Get note value
                    const note = row.querySelector('.attendance-note').value;
                    
                    // Update attendance data
                    attendance[dateKey][studentId] = {
                        status,
                        time: currentTime,
                        note
                    };
                    
                    // Save to localStorage
                    localStorage.setItem('attendance', JSON.stringify(attendance));
                    
                    // Show feedback
                    showToast(`Absensi ${row.querySelector('td:nth-child(2)').textContent} berhasil diperbarui!`);
                    
                    // Update dashboard
                    updateDashboard();
                });
            });
            
            // Add event listeners to note inputs
            document.querySelectorAll('.attendance-note').forEach(input => {
                input.addEventListener('change', (e) => {
                    const studentId = parseInt(e.target.dataset.id);
                    const note = e.target.value;
                    const dateKey = document.getElementById('attendance-date-input').value;
                    
                    // Update note in attendance data
                    if (attendance[dateKey] && attendance[dateKey][studentId]) {
                        attendance[dateKey][studentId].note = note;
                        localStorage.setItem('attendance', JSON.stringify(attendance));
                    }
                });
            });
        }

        document.getElementById('attendance-class').addEventListener('change', renderAttendanceTable);
        document.getElementById('attendance-date-input').addEventListener('change', (e) => {
            document.getElementById('attendance-date').textContent = formatDate(new Date(e.target.value));
            renderAttendanceTable();
        });

        document.getElementById('save-attendance').addEventListener('click', () => {
            showToast('Semua data absensi telah disimpan!');
        });

        // Grades Management
        function renderGradesTable() {
            const selectedClass = document.getElementById('grades-class').value;
            const selectedType = document.getElementById('grades-type').value;
            const noDataMsg = document.getElementById('no-grades-data');
            
            // Hide all tabs
            document.querySelectorAll('.grades-tab').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Show selected tab
            document.getElementById(`${selectedType}-tab`).classList.remove('hidden');
            
            // Get students for the selected class
            const classStudents = students.filter(student => student.class === selectedClass);
            
            // Show/hide no data message
            if (classStudents.length === 0) {
                noDataMsg.textContent = 'Tidak ada siswa di kelas ini';
                noDataMsg.classList.remove('hidden');
                return;
            } else {
                noDataMsg.classList.add('hidden');
            }
            
            // Render appropriate table based on selected type
            switch (selectedType) {
                case 'tugas':
                    renderTugasTable(classStudents);
                    break;
                case 'uts':
                    renderUtsTable(classStudents);
                    break;
                case 'uas':
                    renderUasTable(classStudents);
                    break;
            }
        }

        function renderTugasTable(classStudents) {
            const tableBody = document.getElementById('tugas-table');
            tableBody.innerHTML = '';
            
            classStudents.forEach(student => {
                const studentGrades = grades.tugas[student.id] || { tugas1: 0, tugas2: 0, tugas3: 0 };
                const average = calculateAverage([studentGrades.tugas1, studentGrades.tugas2, studentGrades.tugas3]);
                
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-200 hover:bg-gray-50';
                
                row.innerHTML = `
                    <td class="py-3 px-6 text-left">${student.nis}</td>
                    <td class="py-3 px-6 text-left">${student.name}</td>
                    <td class="py-3 px-6 text-center">
                        <input type="number" min="0" max="100" class="tugas-grade border rounded px-2 py-1 w-16 focus:outline-none focus:ring-2 focus:ring-red-500" 
                            data-id="${student.id}" data-type="tugas1" value="${studentGrades.tugas1}">
                    </td>
                    <td class="py-3 px-6 text-center">
                        <input type="number" min="0" max="100" class="tugas-grade border rounded px-2 py-1 w-16 focus:outline-none focus:ring-2 focus:ring-red-500" 
                            data-id="${student.id}" data-type="tugas2" value="${studentGrades.tugas2}">
                    </td>
                    <td class="py-3 px-6 text-center">
                        <input type="number" min="0" max="100" class="tugas-grade border rounded px-2 py-1 w-16 focus:outline-none focus:ring-2 focus:ring-red-500" 
                            data-id="${student.id}" data-type="tugas3" value="${studentGrades.tugas3}">
                    </td>
                    <td class="py-3 px-6 text-center font-medium">${average}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        function renderUtsTable(classStudents) {
            const tableBody = document.getElementById('uts-table');
            tableBody.innerHTML = '';
            
            classStudents.forEach(student => {
                const utsGrade = grades.uts[student.id] || 0;
                
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-200 hover:bg-gray-50';
                
                row.innerHTML = `
                    <td class="py-3 px-6 text-left">${student.nis}</td>
                    <td class="py-3 px-6 text-left">${student.name}</td>
                    <td class="py-3 px-6 text-center">
                        <input type="number" min="0" max="100" class="uts-grade border rounded px-2 py-1 w-16 focus:outline-none focus:ring-2 focus:ring-red-500" 
                            data-id="${student.id}" value="${utsGrade}">
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        function renderUasTable(classStudents) {
            const tableBody = document.getElementById('uas-table');
            tableBody.innerHTML = '';
            
            classStudents.forEach(student => {
                const uasGrade = grades.uas[student.id] || 0;
                
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-200 hover:bg-gray-50';
                
                row.innerHTML = `
                    <td class="py-3 px-6 text-left">${student.nis}</td>
                    <td class="py-3 px-6 text-left">${student.name}</td>
                    <td class="py-3 px-6 text-center">
                        <input type="number" min="0" max="100" class="uas-grade border rounded px-2 py-1 w-16 focus:outline-none focus:ring-2 focus:ring-red-500" 
                            data-id="${student.id}" value="${uasGrade}">
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        function calculateAverage(values) {
            const sum = values.reduce((total, value) => total + parseFloat(value || 0), 0);
            return Math.round(sum / values.length);
        }

        function calculateFinalGrade(tugasAvg, uts, uas) {
            // Formula: 30% tugas + 30% UTS + 40% UAS
            return Math.round((0.3 * tugasAvg) + (0.3 * uts) + (0.4 * uas));
        }

        document.getElementById('grades-class').addEventListener('change', renderGradesTable);
        document.getElementById('grades-type').addEventListener('change', renderGradesTable);

        document.getElementById('save-grades').addEventListener('click', () => {
            const selectedType = document.getElementById('grades-type').value;
            
            switch (selectedType) {
                case 'tugas':
                    const tugasInputs = document.querySelectorAll('.tugas-grade');
                    tugasInputs.forEach(input => {
                        const studentId = parseInt(input.dataset.id);
                        const type = input.dataset.type;
                        const value = parseInt(input.value) || 0;
                        
                        if (!grades.tugas[studentId]) {
                            grades.tugas[studentId] = { tugas1: 0, tugas2: 0, tugas3: 0 };
                        }
                        
                        grades.tugas[studentId][type] = value;
                    });
                    break;
                    
                case 'uts':
                    const utsInputs = document.querySelectorAll('.uts-grade');
                    utsInputs.forEach(input => {
                        const studentId = parseInt(input.dataset.id);
                        const value = parseInt(input.value) || 0;
                        
                        grades.uts[studentId] = value;
                    });
                    break;
                    
                case 'uas':
                    const uasInputs = document.querySelectorAll('.uas-grade');
                    uasInputs.forEach(input => {
                        const studentId = parseInt(input.dataset.id);
                        const value = parseInt(input.value) || 0;
                        
                        grades.uas[studentId] = value;
                    });
                    break;
            }
            
            localStorage.setItem('grades', JSON.stringify(grades));
            showToast('Data nilai berhasil disimpan!');
        });

        document.getElementById('export-grades').addEventListener('click', () => {
            const selectedClass = document.getElementById('grades-class').value;
            const selectedType = document.getElementById('grades-type').value;
            
            // Get students for the selected class
            const classStudents = students.filter(student => student.class === selectedClass);
            
            let csvContent = '';
            let filename = '';
            
            switch (selectedType) {
                case 'tugas':
                    csvContent = 'NIS,Nama,Tugas 1,Tugas 2,Tugas 3,Rata-rata\n';
                    
                    classStudents.forEach(student => {
                        const studentGrades = grades.tugas[student.id] || { tugas1: 0, tugas2: 0, tugas3: 0 };
                        const average = calculateAverage([studentGrades.tugas1, studentGrades.tugas2, studentGrades.tugas3]);
                        
                        csvContent += `${student.nis},"${student.name}",${studentGrades.tugas1},${studentGrades.tugas2},${studentGrades.tugas3},${average}\n`;
                    });
                    
                    filename = `Nilai_Tugas_Kelas_${selectedClass}.csv`;
                    break;
                    
                case 'uts':
                    csvContent = 'NIS,Nama,Nilai Sumatif Tengah Semester\n';
                    
                    classStudents.forEach(student => {
                        const utsGrade = grades.uts[student.id] || 0;
                        
                        csvContent += `${student.nis},"${student.name}",${utsGrade}\n`;
                    });
                    
                    filename = `Nilai_UTS_Kelas_${selectedClass}.csv`;
                    break;
                    
                case 'uas':
                    csvContent = 'NIS,Nama,Nilai Sumatif Akhir Semester\n';
                    
                    classStudents.forEach(student => {
                        const uasGrade = grades.uas[student.id] || 0;
                        
                        csvContent += `${student.nis},"${student.name}",${uasGrade}\n`;
                    });
                    
                    filename = `Nilai_UAS_Kelas_${selectedClass}.csv`;
                    break;
            }
            
            // Create download link
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', filename);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showToast('Nilai berhasil diekspor!');
        });

        // Report Generation
        function renderReportTable() {
            const reportType = document.getElementById('report-type').value;
            
            // Hide all report sections
            document.getElementById('attendance-report').classList.add('hidden');
            document.getElementById('grades-report').classList.add('hidden');
            
            // Show selected report section
            if (reportType === 'attendance') {
                document.getElementById('attendance-report').classList.remove('hidden');
                renderAttendanceReport();
            } else {
                document.getElementById('grades-report').classList.remove('hidden');
                renderGradesReport();
            }
        }

        function renderAttendanceReport() {
            const tableBody = document.getElementById('report-table');
            const noDataMsg = document.getElementById('no-report-data');
            const selectedClass = document.getElementById('report-class').value;
            const selectedMonth = parseInt(document.getElementById('report-month').value);
            
            // Clear table
            tableBody.innerHTML = '';
            
            // Filter students
            let filteredStudents = students;
            if (selectedClass !== 'all') {
                filteredStudents = filteredStudents.filter(student => student.class === selectedClass);
            }
            
            // Show/hide no data message
            if (filteredStudents.length === 0) {
                noDataMsg.textContent = 'Tidak ada siswa untuk ditampilkan';
                noDataMsg.classList.remove('hidden');
                return;
            }
            
            // Calculate attendance statistics
            let hasAttendanceData = false;
            
            filteredStudents.forEach(student => {
                const stats = {
                    present: 0,
                    sick: 0,
                    permit: 0,
                    absent: 0,
                    total: 0
                };
                
                // Loop through attendance data
                Object.keys(attendance).forEach(dateKey => {
                    const date = new Date(dateKey);
                    const month = date.getMonth() + 1;
                    
                    if (month === selectedMonth && attendance[dateKey][student.id]) {
                        hasAttendanceData = true;
                        stats.total++;
                        
                        const status = attendance[dateKey][student.id].status;
                        if (status === 'H') stats.present++;
                        else if (status === 'S') stats.sick++;
                        else if (status === 'I') stats.permit++;
                        else if (status === 'A') stats.absent++;
                    }
                });
                
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-200 hover:bg-gray-50';
                
                const percentage = stats.total > 0 ? Math.round((stats.present / stats.total) * 100) : 0;
                
                row.innerHTML = `
                    <td class="py-3 px-6 text-left">${student.nis}</td>
                    <td class="py-3 px-6 text-left">${student.name}</td>
                    <td class="py-3 px-6 text-center">Kelas ${student.class}</td>
                    <td class="py-3 px-6 text-center">${stats.present}</td>
                    <td class="py-3 px-6 text-center">${stats.sick}</td>
                    <td class="py-3 px-6 text-center">${stats.permit}</td>
                    <td class="py-3 px-6 text-center">${stats.absent}</td>
                    <td class="py-3 px-6 text-center">
                        <div class="flex items-center">
                            <div class="w-full bg-gray-200 rounded-full h-2.5">
                                <div class="bg-red-600 h-2.5 rounded-full" style="width: ${percentage}%"></div>
                            </div>
                            <span class="ml-2">${percentage}%</span>
                        </div>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Show/hide no data message
            if (!hasAttendanceData) {
                noDataMsg.textContent = 'Belum ada data absensi untuk bulan ini';
                noDataMsg.classList.remove('hidden');
            } else {
                noDataMsg.classList.add('hidden');
            }
        }

        function renderGradesReport() {
            const tableBody = document.getElementById('grades-report-table');
            const noDataMsg = document.getElementById('no-grades-report-data');
            const selectedClass = document.getElementById('grades-report-class').value;
            const selectedType = document.getElementById('grades-report-type').value;
            
            // Clear table
            tableBody.innerHTML = '';
            
            // Filter students
            let filteredStudents = students;
            if (selectedClass !== 'all') {
                filteredStudents = filteredStudents.filter(student => student.class === selectedClass);
            }
            
            // Show/hide no data message
            if (filteredStudents.length === 0) {
                noDataMsg.textContent = 'Tidak ada siswa untuk ditampilkan';
                noDataMsg.classList.remove('hidden');
                return;
            } else {
                noDataMsg.classList.add('hidden');
            }
            
            // Populate table
            filteredStudents.forEach(student => {
                const tugasGrades = grades.tugas[student.id] || { tugas1: 0, tugas2: 0, tugas3: 0 };
                const utsGrade = grades.uts[student.id] || 0;
                const uasGrade = grades.uas[student.id] || 0;
                
                const tugasAvg = calculateAverage([tugasGrades.tugas1, tugasGrades.tugas2, tugasGrades.tugas3]);
                const finalGrade = calculateFinalGrade(tugasAvg, utsGrade, uasGrade);
                
                // Skip if filtering by type and no data
                if (selectedType === 'tugas' && tugasAvg === 0) return;
                if (selectedType === 'uts' && utsGrade === 0) return;
                if (selectedType === 'uas' && uasGrade === 0) return;
                
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-200 hover:bg-gray-50';
                
                row.innerHTML = `
                    <td class="py-3 px-6 text-left">${student.nis}</td>
                    <td class="py-3 px-6 text-left">${student.name}</td>
                    <td class="py-3 px-6 text-center">Kelas ${student.class}</td>
                    <td class="py-3 px-6 text-center">${tugasGrades.tugas1}</td>
                    <td class="py-3 px-6 text-center">${tugasGrades.tugas2}</td>
                    <td class="py-3 px-6 text-center">${tugasGrades.tugas3}</td>
                    <td class="py-3 px-6 text-center font-medium">${tugasAvg}</td>
                    <td class="py-3 px-6 text-center font-medium">${utsGrade}</td>
                    <td class="py-3 px-6 text-center font-medium">${uasGrade}</td>
                    <td class="py-3 px-6 text-center font-bold">${finalGrade}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        document.getElementById('report-type').addEventListener('change', renderReportTable);
        document.getElementById('report-class').addEventListener('change', renderAttendanceReport);
        document.getElementById('report-month').addEventListener('change', renderAttendanceReport);
        document.getElementById('grades-report-class').addEventListener('change', renderGradesReport);
        document.getElementById('grades-report-type').addEventListener('change', renderGradesReport);

        document.getElementById('export-report').addEventListener('click', () => {
            const reportType = document.getElementById('report-type').value;
            
            if (reportType === 'attendance') {
                exportAttendanceReport();
            } else {
                exportGradesReport();
            }
        });

        function exportAttendanceReport() {
            const selectedClass = document.getElementById('report-class').value;
            const selectedMonth = parseInt(document.getElementById('report-month').value);
            const monthNames = [
                'Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni',
                'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'
            ];
            
            // Create CSV content
            let csvContent = 'NIS,Nama,Kelas,Hadir,Sakit,Izin,Alpha,Persentase\n';
            
            // Filter students
            let filteredStudents = students;
            if (selectedClass !== 'all') {
                filteredStudents = filteredStudents.filter(student => student.class === selectedClass);
            }
            
            filteredStudents.forEach(student => {
                const stats = {
                    present: 0,
                    sick: 0,
                    permit: 0,
                    absent: 0,
                    total: 0
                };
                
                // Loop through attendance data
                Object.keys(attendance).forEach(dateKey => {
                    const date = new Date(dateKey);
                    const month = date.getMonth() + 1;
                    
                    if (month === selectedMonth && attendance[dateKey][student.id]) {
                        stats.total++;
                        
                        const status = attendance[dateKey][student.id].status;
                        if (status === 'H') stats.present++;
                        else if (status === 'S') stats.sick++;
                        else if (status === 'I') stats.permit++;
                        else if (status === 'A') stats.absent++;
                    }
                });
                
                const percentage = stats.total > 0 ? Math.round((stats.present / stats.total) * 100) : 0;
                
                csvContent += `${student.nis},"${student.name}",Kelas ${student.class},${stats.present},${stats.sick},${stats.permit},${stats.absent},${percentage}%\n`;
            });
            
            // Create download link
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', `Laporan_Absensi_${selectedClass === 'all' ? 'Semua_Kelas' : 'Kelas_' + selectedClass}_${monthNames[selectedMonth-1]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showToast('Laporan absensi berhasil diekspor!');
        }

        function exportGradesReport() {
            const selectedClass = document.getElementById('grades-report-class').value;
            const selectedType = document.getElementById('grades-report-type').value;
            
            // Create CSV content
            let csvContent = 'NIS,Nama,Kelas,Tugas 1,Tugas 2,Tugas 3,Rata-rata Tugas,UTS,UAS,Nilai Akhir\n';
            
            // Filter students
            let filteredStudents = students;
            if (selectedClass !== 'all') {
                filteredStudents = filteredStudents.filter(student => student.class === selectedClass);
            }
            
            filteredStudents.forEach(student => {
                const tugasGrades = grades.tugas[student.id] || { tugas1: 0, tugas2: 0, tugas3: 0 };
                const utsGrade = grades.uts[student.id] || 0;
                const uasGrade = grades.uas[student.id] || 0;
                
                const tugasAvg = calculateAverage([tugasGrades.tugas1, tugasGrades.tugas2, tugasGrades.tugas3]);
                const finalGrade = calculateFinalGrade(tugasAvg, utsGrade, uasGrade);
                
                // Skip if filtering by type and no data
                if (selectedType === 'tugas' && tugasAvg === 0) return;
                if (selectedType === 'uts' && utsGrade === 0) return;
                if (selectedType === 'uas' && uasGrade === 0) return;
                
                csvContent += `${student.nis},"${student.name}",Kelas ${student.class},${tugasGrades.tugas1},${tugasGrades.tugas2},${tugasGrades.tugas3},${tugasAvg},${utsGrade},${uasGrade},${finalGrade}\n`;
            });
            
            // Create download link
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            
            let filename = 'Laporan_Nilai';
            if (selectedClass !== 'all') {
                filename += `_Kelas_${selectedClass}`;
            }
            if (selectedType !== 'all') {
                const typeNames = {
                    'tugas': 'Tugas',
                    'uts': 'UTS',
                    'uas': 'UAS'
                };
                filename += `_${typeNames[selectedType]}`;
            }
            filename += '.csv';
            
            link.setAttribute('download', filename);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showToast('Laporan nilai berhasil diekspor!');
        }

        // Dashboard Updates
        function updateDashboard() {
            // Update current date
            document.getElementById('current-date').textContent = formatDate(new Date());
            
            // Update total students
            document.getElementById('total-students').textContent = students.length;
            
            // Update attendance for today
            const today = new Date().toISOString().split('T')[0];
            const todayAttendance = attendance[today] || {};
            
            let presentCount = 0;
            let absentCount = 0;
            
            Object.values(todayAttendance).forEach(record => {
                if (record.status === 'H') {
                    presentCount++;
                } else {
                    absentCount++;
                }
            });
            
            document.getElementById('present-today').textContent = presentCount;
            document.getElementById('absent-today').textContent = absentCount;
            
            // Update class summary
            const classSummary = document.getElementById('class-summary');
            classSummary.innerHTML = '';
            
            for (let classNum = 7; classNum <= 9; classNum++) {
                const classStudents = students.filter(student => student.class === classNum.toString());
                const classTotal = classStudents.length;
                
                let classPresent = 0;
                classStudents.forEach(student => {
                    if (todayAttendance[student.id] && todayAttendance[student.id].status === 'H') {
                        classPresent++;
                    }
                });
                
                const percentage = classTotal > 0 ? Math.round((classPresent / classTotal) * 100) : 0;
                
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-200 hover:bg-gray-50';
                
                row.innerHTML = `
                    <td class="py-3 px-6 text-left">Kelas ${classNum}</td>
                    <td class="py-3 px-6 text-center">${classTotal}</td>
                    <td class="py-3 px-6 text-center">${classPresent}</td>
                    <td class="py-3 px-6 text-center">
                        <div class="flex items-center">
                            <div class="w-full bg-gray-200 rounded-full h-2.5">
                                <div class="bg-red-600 h-2.5 rounded-full" style="width: ${percentage}%"></div>
                            </div>
                            <span class="ml-2">${percentage}%</span>
                        </div>
                    </td>
                `;
                
                classSummary.appendChild(row);
            }
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', () => {
            // Set default date for attendance
            const today = new Date();
            document.getElementById('attendance-date-input').value = today.toISOString().split('T')[0];
            document.getElementById('attendance-date').textContent = formatDate(today);
            
            // Set default month for reports
            const currentMonth = today.getMonth() + 1;
            document.getElementById('report-month').value = currentMonth;
            
            // Show dashboard by default
            switchTab('dashboard');
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96218dadd0fafda8',t:'MTc1MzAwNTAxNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
